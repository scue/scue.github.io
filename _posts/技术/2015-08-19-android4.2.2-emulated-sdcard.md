---
layout: post
title: "Android 4.2.2 Emulate Sdcard"
description: ""
category: 技术
tags: [tag]
---

参考链接: [source.android.com](https://source.android.com/devices/storage/config-example.html)

由于官方提供的参考方法不能使用, 所以我把修改的配置贴了出来

### init.hardware.rc


```
on post-fs-data
    mkdir /data/media 0770 media_rw media_rw
    chown media_rw media_rw /data/media

on init
    mkdir /mnt/shell/emulated 0771 system sdcard_rw
    mkdir /mnt/shell/test 0771 system sdcard_rw
    mkdir /storage/emulated 0775 root root

    export EXTERNAL_STORAGE /storage/emulated/0
    export EMULATED_STORAGE_SOURCE /mnt/shell/emulated
    export EMULATED_STORAGE_TARGET /storage/emulated

    # Support legacy paths
    symlink /storage/emulated/0 /sdcard
    symlink /storage/emulated/0 /mnt/sdcard
    symlink /storage/emulated/0 /storage/sdcard0
    symlink /mnt/shell/emulated/0 /storage/emulated/0

service sdcard /system/bin/sdcard /data/media /mnt/shell/emulated 1023 1023
    disabled

on property:dev.bootcomplete=1
    start sdcard
```

### storage_list.xml

```
<storage
        android:storageDescription="@string/storage_internal"
        android:emulated="true"
        android:mtpReserve="100" />
```
